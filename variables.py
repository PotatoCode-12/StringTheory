import math
from scipy.integrate import quad
import numpy as np 
import sympy as sp
from sympy import symbols, diff,integrate, Function, Derivative
point = symbols('point') # adjust running point variable
CEnergy1= symbols('CEnergy1')
CEnergy2 = symbols('CEnergy2')
GNewton = symbols('GNewton')
mu = symbols('mu')
xb = Function('xb')(mu) #import for formal x(t) definition
xa = Function('xa')(mu) #import for formal x(t) definition
v = symbols('v') #import for formal v(t) definition
a = symbols('a') #import translation
t = symbols('t') 
tp = symbols('tp') #alt.var names
mup = symbols('mup') #alt.var names
taup = symbols('mup taup') #alt.var names
sigmap = symbols('sigmap') #alt.var names
sigma = symbols('sigma') #import for formal sigma(t) definition
lamda = Function('lambda')(mu,v) #import for formal lamda(t) definition
SlopeRegge = symbols('SlopeRegge') #import for formal SlopeRegge definition
a, b = symbols('a b')
xap = Function('xap')(mup, tp, sigmap) #import for formal xap(t) definition
tau = symbols('tau') 
h = Function('h')(a, b)
t = symbols('t') # Define the tetrad function n(t) using the WorldLineMetric
m= symbols('m') # mass
xav= Function('xav')(mu, sigma) #import for formal xav(t) 
ubdiff = Function('u1')(mu)
uadiff = Function('u2')(mu)
ua = Function('ua')(mu)
ub = Function('ub')(mu)
n = symbols('n') # stepper
WorldLineMetric= symbols('WorldLineMetric')
def tetrad(t):
    -WorldLineMetric(t)**(1/2)   #tetrad
h(a,b)= xa*xb*Derivative(h, a)*Derivative(h, b)
WorldSheet = symbols('WorldSheet') # bs make it better <3
WorldSheetMetric = Function('WorldSheetMetric')(a*b, tau, sigma)
GWorldSheetMetric = np.linalg.det(WorldSheetMetric)
NambuGotoVar = Function('NambuGotoVar')(GWorldSheetMetric)
x = symbols('x') 
EquMotion = Function('EquMotion')(WorldLineMetric)
c = symbols('c') 
d = symbols('d')
WorldSheetMetricE = Function('WorldSheetMetricE')(a*b, tau, sigma)
WorldSheetMetricP = Function('WorldSheetMetricP')(a*b, tau, sigma)
NWorldSheetMetric = Function('NWorldSheetMetric')(a*b, taup, sigmap)
omega = Function('omega')(tau, sigma) #variable point
TF = function('TF')(tau, sigma)
l = symbols('l') #bounds on sigma
def FreeStringPropagation(
    n_sigma=100,
    n_tau=200,
    sigma_max=1.0,
    tau_max=1.0,
    c=1.0,
    initial_condition=None
) -> np.ndarray:
    d_sigma = sigma_max / (n_sigma - 1)
    d_tau = tau_max / (n_tau - 1)

    # CFL stability condition
    assert c * d_tau / d_sigma <= 1.0

    # Grid initialization
    X = np.zeros((n_tau, n_sigma))
    sigma = np.linspace(0, sigma_max, n_sigma)

    # Initial condition at τ = 0
    if initial_condition is None:
        X[0, :] = np.sin(np.pi * sigma / sigma_max)  # default: standing wave
    else:
        X[0, :] = initial_condition(sigma)

    # Zero initial velocity: ∂_tau X = 0 at τ = 0
    X[1, 1:-1] = (
        X[0, 1:-1] +
        0.5 * (c * d_tau / d_sigma)**2 * (X[0, 2:] - 2 * X[0, 1:-1] + X[0, :-2])
    )

    # Time evolution
    for tau in range(1, n_tau - 1):
        X[tau + 1, 1:-1] = (
            2 * X[tau, 1:-1] - X[tau - 1, 1:-1] +
            (c * d_tau / d_sigma)**2 * (X[tau, 2:] - 2 * X[tau, 1:-1] + X[tau, :-2])
        )
        # Fixed (Dirichlet) boundaries
        X[tau + 1, 0] = 0
        X[tau + 1, -1] = 0

    return X
bnds = symbols('bnds') #covarient boundry conditions
chi = symbols('chi') #term beyond original Sp
ScalarRicci = symbols('ScalarRicci')
ScalarRicciP = symbols('ScalarRicciP')
def rescaled_laplacian(laplacian, lambda_scale):
    return (1 / lambda_scale**2) * laplacian
AppNambuGotoP = Function('AppNambuGotoP')(GWorldSheetMetric)
lamdas = symbols('lamdas')
D = symbols('D') #spacetime dimensions
i = D -1
aaneg = symbols('aaneg')
aapos = symbols('aapos')   
baneg = symbols('baneg')
bapos = symbols('bapos')
aa = Function('aa')(mu)
bb = Function('bb')(mu)
abneg = symbols('abneg')
abpos = symbols('abpos')
bbneg = symbols('bbneg')
bbpos = symbols('bbpos')
ab = Function('ab')(mu)
ba = Function('ba')(mu)
pos = symbols('pos') #positive
neg = symbols('neg') #negative
ActionWorldLine = symbols('ActionWorldLine')
eta = symbols('eta')
xdiffaneg = symbols('xdiffaneg')
xdiff = ('xdiff')
xadiff = Function('xadiff')(mu)
xbdiff = Function('xbdiff')(mu)
pb = Function('pb')(mu) # momentum
pa = Function('pa')(mu) # momentum
L = symbols('l') # Lagrangian
H = symbols('H') # Hamiltonian
j = symbols('j')
cords = Function('cords')(x, mu) #dictate coordinate pair/set 
etap = symbols('etap') 
xbp = Function('xbp')(mu)
fp = Function('fp')(sigmap)
GWorldSheetMetrica = Function('GWorldSheetMetrica')(tau, sigma)
GWorldSheetMetricb = Function('GWorldSheetMetricb')(tau, sigma)
xas = Function('xas')(mu, sigma) 
xbs = Function('xbs')(mu, sigma) 
ya = Function('ya')(mu, sigma)
yb = Function('yb')(mu, sigma)
TensionString = symbols('TensionString')
TensionStringa = Function('TensionStringa')(i)
TensionStringb = Function('TensionStringb')(n)
TensionStringab = Function('TensionStringab')(i, n)
etaa = Function('etaa')(neg, pos)
ConjMomentum = Function('ConjMomentum')(j, sigmap)
dirac = Function('dirac')(x, mu) # Dirac notation
k = Function('k')(pos) # wave number
N = symbols('N') # number operator
hilbert = Function('hilbert')(mu) # Hilbert space
hilbert1 = Function('hilbert1')(mu) # Hilbert space
hilbert2 = Function('hilbert2')(mu) # Hilbert space
A = symbols('A') # electromagnetic potential
epsilon = symbols('epsilon') # small parameter for perturbation
O = Function('O')(epsilon)
S = Function('S')(i, j) # spin
stringtype = symbols('something') # make reflective code to determine string type
s = Function('s')(tau)
TensionStringabtilde = Function('TensionStringab')(i, a) #its totally different, trust me bro, also please send help i thought that was funny in my head but its not its 1:00am and i just started
comm = Function('comm')(xas, pa) #communicators function
deltaa = Function('deltaa')(i, j)
deltab = Function('deltab')(m, n)
Ntilde = symbols('Ntilde') #adjust for approximate bounds
Nb = Function('Nb')(i, n)
Nbtilde = Function('Nbtilde')(i, n)
Atilde = symbols('Atilde')
P = symbols ('momentum conjugate')
bomega = symbols('bomega') #cap omega
D1 = symbols('D1') # for D free scalar fields
D2 = symbols('D1') # for D free scalar fields
z = sigma(D1) + i*(sigma(D2))
zl = sigma(D1) - i*(sigma(D2))
diff(z) = 1/2(diff(D1)-i*D2)
diff(zl) = 1/2(diff(D1)+i*D2)
diff(z, z) = 1
diff(zl, z) = 0
diff(z, zl) = 0
diff(zl, zl) = 1
va = Function('va')(z)
vb = Function('vb')(z)
va(z) = va(D1) + i*va(D2)
va(zl) = va(D1) -i * va(D2)
vb(z) = 1/2(va(D1 - i*va(D2)))
vb(zl) = 1/2(va(D1 + i*va(D2)))
ga = Function('ga')(z, zl)
gb = Function('gb')(z, zl)
gb(z, zl) = gb(zl, z) = 1/2
gb(z, z) =gb(zl, zl) = 0
ga(z, zl) = ga(zl, z) = 2
ga(z, z) = ga(zl, zl) = 0
d2z = i/2*diff(z)**(diff(zl)) = 2*diff(sigma(D1))*diff(sigma(D2))
integrate(d2z*deltaa(D2, z, zl)) = 1
d2va =Function(diff(v, x, 2))
d2vb =Function(diff(v, x, 2))
R = symbols('R') #contour space
X = symbols('X') #path integral thing
PI = Function(X)
bracket = Function('bracket')(x) #point marking with angled brackets
psi = symbols('psi') # for operator value
xahat = Function(xa(mu, z, zl) * psi)
zp = symbols ('zp')
zpl = symbols('zpl')
delta = NambuGotoVar
order = Function('order')(x) # x= stuff
z1 = symbols('z1')
zl1 = symbols('zl1')
z2 = symbols('z2')
zl2 = symbols('zl2')
z12 =  symbols('z12')
zl12 = symbols('zl12')
zb = Function('zb')(i,)
sigmab = Function ('sigma')(D1)
AO = Function('AO')(i, sigmab(D1))
cab = Function('cab')(k, j)
mub = Function('mu')(D1)
zlb = Function('zlb')(i)
subs = symbols('subsitutions') # check instance on page 39
d2z1 = i/2*diff(z1)**(diff(zl1)) = 2*diff(sigma(D1))*diff(sigma(D2))
d2z2 = i/2*diff(z2)**(diff(zl2)) = 2*diff(sigma(D1))*diff(sigma(D2))
NO = symbols('normal_operator')
GO = symbols('general_operator')
G = symbols('G') #39
F = symbols('f') #39
xab = Function('xab')(mu, F, z1, zl1) #39
y = symbols('y')
bbb = Function('bbb')(s, y, m)
phi = symbols('phi')
phip = symbols('phip')
phipb = Function('phip')(b, sigma)
phib = Function('phi')(phi, sigma)
PIC = Function('path_integral_condition')(x)
epsilon = symbols('epsilon')
g = symbols ('g')
ja = Function('ja')(a, sigma)
rho = Function('rho')(sigma)
Deltab = Function('delta')(b)
D0 = symbols('D0')
nb = Function('n')(b)
jtilde = symbols('jtilde')
res = Function('res')(z, zb)
jf= Function('jf')(a)
resl = Function('resl')(zl, zlb)
jab = Function('jab')(a, b)
d2sigma = diff(tau)*diff(sigma)
jb = Function('jb')(b)
Tb = Function('Tb')(a, b)
Tbf = Function('tbf')(a, b, sigma)
Tf = Function('tf')(z)
Tftilde = Function('tftilde')(zl)
vf = Function('vf')(z)
jftilde = Function('jtilde')(zl)
trans = symbols('transpositional')
f = Function('f')(z)
brackets = Function(x) # []
AOa = Function('AOa')(n, z, zl)
AOatilde = Function('AOatilde')(n, z, zl)
AOp = Function('AOp')(zp, zpl)
zetaa = Function('zeta')(h)
zeta = symbols('zeta')
zetaal = Function('zeta')(h)
htilde = Function('h') #modify as needed
OO = Function('OO') 
OOp = Function('OOp')
weight = Function('weight') # for weight cordinates
ea = Function('ea')(x)
ka = Function('ka')(x)
mb = Function('mb')(b)
AOb = Function('AOb')(i, z, zl)
hb = Function('hb')(b)
zab = Function('zab')(a, b)
zlab = Function('zlab')(a, b)
D12 = symbols('D12')
hbtilde = Function('hbtilde')(b)
za = Function('za')(a)
zla = Function('zla')(a)
D4 = symbols('d4')
etaab = Function('etaab')(a, b)
Tfp = Function('tfp')(Tf)
bracketc = Function('bracketc') #{}
Vb= Function('Vb') # some fixed vector
ctilde = symbols('ctilde') # central charge
Va = Function('Va')
bf = Function('b')(f)
cf = Function('c')(f)
btilde = symbols('btilde')
psib = Function('psi')(b)
psia = Function('psi')(a)
psiab = Function('psi')(a, b)
psil = symbols('psil')
psibl = Function('psil')(b)
psial = Function('psil')(a)
psiabl = Function('psil')(a, b)
Beta = symbols('beta')
gamma = symbols('gamma')
gammaf = Function('gammaf')(z)
Betaf = Function('Betaf')(z)
Ttilde = symbols('Ttilde')
sigmaa = Function('sigma')(a)
w = symbols('w') # cordinate
wl = symbols('wl')
Lb = Function('lb')(b) # laurent expansion
Lbtilde = Function('Lbtilde')(b)
Tbftilde = Function('Tbftilde')(zl, zl, zl)
Tbtilde = Function('Tbtilde')(b)
Qb = Function('Q')(b)
Q = symbols('Q')
Qf = Function('Q')(c)
Qbf = Function('Q')(b, c)
Qba = Function('Q')(b, a)
Qa = Function('Q')(a)
Qaf = Function('Q')(a, c)
Qabf = Function('Q')(a, b, c)
C = symbols('C')
C1 = symbols('C1')
C2 = symbols('C2')
C3 = symbols('C3')
C4 = symbols('C4')
Qm1 = symbols('Qm1')
Qm2 = symbols('Qm2')
Qm3 = symbols('Qm3')
Qm4 = symbols('Qm4')
Qm5 = symbols('Qm5')
Qm6 = symbols('Qm6')
Qftilde = Function('Qftilde') (C)
OOb =Function('OOb')(b) # operator with b
na = Function('na')(a)
ta = Function('ta')(a)
alphaa = Function('alpha')(a)
alpha = symbols('alpha')
alphab = Function('alphab')(b)
alphaab = Function('alphaab')(a, b)
alphaatilde = Function('alphatilde')(a)
alphatilde = symbols('alphatilde')
alphabtilde = Function('alphabtilde')(b)
alphaabtilde = Function('alphaabtilde')(a, b)
jatilde = Function('jatilde')(a)
class ANO(): #annihliation class
    nargs = 1
zpa = Function('zp')(a)
zpla = Function('zpla')(a)
brackets1 = Function('brackets1')('in_brackets')
brackets2 = Function('brackets2')('in_brackets')
deltaf = Function('deltaf')(z, z, z, z)
d2zp = i/2*diff(zp)**(diff(zpl)) = 2*diff(sigma(D1))*diff(sigma(D2))
cb = Function('cb')(b)
down =symbols('down') #ground states, down
up = symbols('up') #up
bb0 = Function('bb0')(b)
cb0 = Function('cb0')(b)
bbn = Function('bbn')(b)
cbn = Function('cbn')(b)
Na = Function('na')(a)
cftilde = Function('cftilde')(f)
bftilde = Function('bftilde')(f)
xabs = Function('xabs')(a, b)
jfb = Function ('jfb')(b, f)
qb = Function('qb')(b)
theta = symbols('theta')
thetaa = Function('theta')(a)
thetab = Function('theta')(b)
thetaab = Function('theta')(a, b)
thetaatilde = Function('theta')(a)
thetabtilde = Function('theta')(a)
thetaabtilde = Function('theta')(a, b)
thetatilde = symbols('theta')
bracketsb = Function('bracketsb')(b)
Psi = symbols('psi')
Psib = Function('psi')(b)
Psia = Function('psi')(a)
Psiab = Function('psi')(a, b)
Psil = symbols('psil')
Psibl = Function('psi')(b)
Psial = Function('psi')(a)
Psiabl = Function('psi')(a, b)
Sb = Function('s')(b)
Sa = Function('sa')(a)
Sab = Function('sab')(a, b)
Xp = symbols('Xp')
class dagger(): #dagger notation
    nargs = 1
kp = symbols('kprime')
E = symbols('energy')
lamdab = Function ('lamda')(b)
lamdaa = Function ('lamda')(a)
lamdaab = Function ('lamda')(a, b)
M = symbols('m')
chitilde = symbols('chitilde')
Z = symbols('Z')
gbf = Function('gbf')(b, sigma)
class hat(): #hat :D
    nargs=1
    hat=hat
omegasf = Function('omegasf')(f) # lowercase omega
omegas = symbols('omegas')
Delta = symbols('Delta')
Rp = symbols('Rprime')
gp = symbols('gprime')
Rb = Function('R')(b)
sigmap1 = symbols('sigmap1')
sigmap2 = symbols('sigmap2')
FP = symbols('FP') # faddev-popov
sigmaap = Function('sigmaap')(a)
Deltabf = Function('deltabf')(b, sigma)
Zf = Function('Z')(sigma)
dw = symbols('dw') # diff x weyl
holderb = Function('holderb')(b) # for unitary b offset
P1 = symbols('P1') # not car
Betaa = Function('betaa')(a)
Betap = symbols('Betaa')
Betaap = Function('Betaap')(a)
Deltaa = Function('deltaa')(a)
ca = Function('ca')(b)
holdera = Function('holdera')(a)
tb = Function('Tb')(b)
Tab = Function('Tab')(a, b)
vaf = Function('vaf')(a, z)
W = symbols('W')
d2sigmap = Function('d2sigmap') # cross to d2sigma def
Rf = Function('r')(f)
Gf = Function('G')(sigma, sigmap)
gf = Function(sigma)
deltaaf = Function(deltaa)(f)
hbf = Function('h') (b, z, zp)
D3 = symbols('D3')
Tabf = Function('tab')(a, b, sigma)
FO = Function('FO') # F script operator
RO = Function('RO') # renomalized operator
Deltaf = Function(sigma, sigmap)
d2f = Function('d2f')(sigma, sigmap) # for second derivatives 102.5
r = symbols('r') # renomalizing operator constant
Xf = Function('Xf')(sigma)
dDf = Function('dDf')(k) # Dth derivative of function
epsilona = Function('epsilona')(a)
Ab = Function('Ab')(b)
sb = Function('sb')(b)
kb = Function('kb')(b)
sab = Function('sab')(a, b)
DR = symbols('DR') # different renormalization
o = symbols('o') # open string
InvPoincare = Function('InvPoincare') # poincare invariance
Gb = Function('Gb')(b)
Gbf = Function('Gbf')(b, X)
etab = Function('etab')(b)
chibf = Function('chibf')(b, X)
chib = Function('chib')(b)
Bb = Function('Bb')(b)
Bbf = Function('Bbf')(b, X)
phif = Function('phif')(X)
zetabf = Function('zetabf')(b, X)
zetab = Function('zetab')(b)
B = symbols('B')
Betaab = Function('Betaab')(a, b)
phiab = Function('phiab')(a, b)
chiab = Function('chiab')(a, b)
Hb = Function('Hb')(b, b, b)
RB = Function('RB') # R-bolded
Of = Function('Of')(r) 
Hba = Function('Hba')(b, a)
Hab = Function('Hab')(a, b)
RBb = Function('RBb')(b)
SB = Function('SB')
Ha = Function('Ha')(a)
kappa = symbols('kappa')
kappab = Function('kappab')(b)
kappaa = Function('kappaa')(a)
kappaab = Function('kappaab')(a, b)
Betaabp = Function('Betaabp')(a, b) # for power of Betab
Gbftilde = Function('Gbftilde')(b, X)
RBtilde = symbols('RBtilde')
phitilde = symbols('phitilde')
mutilde = symbols('mutilde')
Gtilde = symbols('Gtilde')
Hatilde = Function('Hatilde')(a)
Ga = Function('Ga')(a)
Mb = Function('Mb')(P)
Tr = symbols('tr')
Trf = Function('Trf')(mu)
Fa = Function('Fa')(a)
Fb = Function('Fb')(b)
Fbp = Function('Fbp')(b)
Abp = Function('Abp')(b)
Taf = Function('Taf')(a, sigma)
psip = symbols('psip')
Lab = Function('Lab')(a, b)
hilbertb = Function('hilbertb')(b)
phys = symbols('phys')
null = symbols('null')
e = symbols('e')
class star():
    nargs = 1 # for *'s
eb = Function('eb')(b)
lightcone = symbols('lightcone')
fab = Function('fab')(a, b)
Faf = Function('Faf')(a, phi)
fpb = Function('fpb')(a, b) # power, b
gauge = symbols('gauge')
Ma = Function('Ma')(a)
Qab = Function('Qab')(a, b)
deltabp = Function('deltabp')(b)
epsilonp = symbols('epsilonp')
BRST = symbols('BRST')
closed = symbols('closed')
exact = symbols('exact')
taub = Function('taub')(b)
ef = Function('ef')(tau)
Hn = symbols ('Hn') # latin H
Ta = Function('ta')(a)
Tatilde = Function('Tatilde')(a)
Ba = Function('ba')(a)
jbtilde = Function('Jbtilde')(b)
cbtilde = Function('cbtilde')(b)
Labtilde = Function('labtilde')(a, b)
K = symbols('K')
J = symbols('J')
I = symbols('I')
Gab = Function('gab')(a, b)
gab = Function('gab')(a, b)
Ls = symbols('L') # for L
bbtilde = Function('bbtilde')(b)
alphap = symbols('alphap')
ep = symbols('ep')
p = symbols('p')
mtilde =symbols('mtilde')
Ip = symbols('Ip')
kbp = Function('kbp')(b)
Jp = symbols('jp')
posneg = symbols('posneg') # +/-
U = symbols('U')
psibp = Function('psibp')(b)
T = symbols('T')
taupf = Function('taupf')(tau)
taupp = symbols('taupp')
line = Function('line')(a, b, c)
linea = Function('linea')(b, a)
sigmaatilde = Function('sigmaatilde')(a)
MO = symbols('MO') # modulous space
MOb = Function('MOb')(b)
MOa = Function('MOa')(a)
gO = symbols('gO') # script g
gOb = Function('gOb')(b)
diffxweyl = symbols('diffxweyl')
difff = Function('difff')(x)
difffb = Function('difff')(x, b)
difffa = Function('difff')(x, a)
deltap = symbols('deltap')
P1a = Function('P1a')(a)
keta = symbols('keta')
fabf = Function('fabf')(a, b, x)
sigmaab = Function('sigmaab')(a, b)
da = Function('da')(a)
Betabp = Function('Betab')(b)
daf = Function('daf')(a, x)
caf = Function('caf')(a, x)
Cabnf = Function('Cabnf')(b, x)
Bbnf = Function('Bbnf')(b, x)
bbf = Function('bbf')(b, x)
Cabn = Function('Cabn')(a, b)
vabp = Function('vabp')(a, b)
Bbn = Function('Bbn')(b)
vab = Function('vab')(a, b)
Cbn = Function('Cbn')(b)
Kp = symbols('Kp')
Babn = Function('Babn')(a, b)
vbp = Function('vbp')(b)
kpp = symbols('kpp')
# for det'
def detp():
    Mvariables = sp.Matrix(detp())
    eigs = Mvariables.eigenvals()   # dict {eigenvalue: multiplicity}
    # Step 2: build product of nonzero eigenvalues
    det_prime = 1
    for eig, mult in eigs.Mvariables():
        if eig != 0:   # skip zero-modes
            det_prime *= eig**mult
jp = symbols('jp')
dim = symbols('dim')
ker = symbols('ker')
Pab = Function('pab')(a, b)
Pb = Function('Pb')
gbfp = Function('gbfp')(b, x, y)
gap = Function('gap')(a)
gbp = Function('gbp')(b)
VOb = Function('VOb')(b)
muab = Function('muab')(a, b)
muba = Function('muba')(b, a)
zbp = Function('zbp')(b)
Cb = Function('Cb')(b)
zlbp = Function('zlbp')(b)
u = symbols('u')
ul = symbols('ul')
abp = Function('abp')(b)
Jf = Function('Jf')(sigma)
Xbfn = Function('Xbfn')(b, sigma)
omegaabs = Function('omegaabs')(a, b)
Xbn = Function('Xbn')(b)
Jb = Function('j')(b)
xbas = Function('xbas')(b, a)
Jab = Function('Jab')(a, b)
Jaf = Function('Jaf')(a, sigma)
Gfp = Function('Gfp')(sigma)
Xabn = Function('Xabn')(a, b)
Aabf = Function('aabf')(a, b, sigma)
Cab = Function('Cab')(a, b)
kab = Function('kab')(a, b)
Gbfp = Function('Gbfp')(b, sigma)
holderab = Function('holderab')(a, b)
d2 = Function('d2')(sigma, sigmap) # for d^2 multiple terms
omegaf = Function('omegaf')(sigma)
vabtilde = Function('vabtilde')(a, b)
Db = Function('Db')(b)
bracketb = Function('bracketb')(b)
ybp = Function('ybp')(b)
qaf = Function('qaf')(a, sigma)
Can = Function('Can')(a)
zabp = Function('zabp')(a, b)
bracketl = Function('bracketl')(x)
bracketla = Function('bracketla')(x, a)
bracketlb = Function('bracketlb')(x, b)
mab = Function('mab')((a, b))
def with_swap(f, swaps1, swaps2):
    base = f()
    swapped1 = [f().xreplace(swaps1) for swaps2 in f]
    swapped2 = [f().xreplace(swaps2) for swaps1 in f]
    return base + sum(swapped1, swapped2)
If = Function('If')(s, t)
Bf = Function('Bf')(a, b)
alphaaf = Function('alphaaf')(a, s)
alphabf = Function('alphabf')(b, s)
wa = Function('wa')(a)
Rho = Function('Rho')(a)
class semigroup():
    1
eaf = Function('eaf')(a, y)
phis = symbols('phis')
phisa = Function('phisa')(a)
omegaa = Function('omegaa')(a)
omegabs = Function('omegabs')(b)
ip = symbols('ip') # i prime
gammab = Function('gammab')(b)
gammaab = Function('gammaab')(a, b)
omegab = Function('omegab')(b)
omegaab = Function('omegaab')(a, b)
gammaa = Function('gammaa')(a)
Ub = Function('Ub')(b)
Uab = Function('Uab')(a, b)
diracp = Function('diracp')(x, y, z)
gammap = symbols('gammap')
AObp = Function('AObp')(b, sigma)
gammaal = Function('gammaal')(a)
q = symbols('q')
diracbs = Function('diracbs')(i, j)
gOa = Function('gOa')(a, x)
pointp = Function('pointp')(x)
diracb = Function('diracb')(x, y, z) # backwards dirac notation
pp = symbols('pp')
AOl = Function('AOl')(x)
ia = Function('ia')(a)
OOl = Function('OOl')(z)
AObl = Function('AObl')(b)
il = symbols('il')
Re = symbols('re')
wp = symbols('wp')
thetavar = Function('thetavar')(x, y)
Gpf = Function('Gpf')(x, y)
wpl = symbols('wpl')
thetavarb = Function('thetavarb')(b, x, y)
Im = symbols('im') # imaginary permutations
kf = Function('kf')(x, y)
taul = symbols('taul')
ql = symbols('ql')
qa = Function('Qa')(a)
qla = Function('qla')(a)
Zbf = Function('Zbf')(b, x)
etaf = Function('eta')(x)
ds2 = symbols('ds2')
wla = Function('wla')(a)
thetavarab = Function('thetavar')(a, b, x, y)
tauab = Function('tauab')(a, b)
jacobithetavar = Function('words')(a, b, x, y)
jacobiriemann = Function('words')(a, b, x, y) #for ab thetavar
Zb = Function('Zb')(b)
hilberta = Function('hilberta')(a)
perp = symbols('perp') # for perpendicular lines
ma = Function('ma')(a)
ZBbf = Function('ZBbf')(b, x)
vac = symbols('vac') # vacuums
rhob = Function('rhob')(b)
kB = symbols('kB')
diff2 = Function('diff2') # partial differentiation symbol ^2
FBb = Function('FBb')(b)
Trbpf = Function('Trbpf')(b, x)
hilbertab = Function('hilbertab')(a, b)
Lamda = symbols('Lamda')
Kb = Function('Kb')(b)
negpos = symbols('negpos')
sa = Function('sa')(a)
lamdaf = Function('lamdaf')
xaps = Function('xapf')(a, x)
phibf = Function('phibf')(b, x)
Ra = Function('Ra')(a)
ketaab = Function('ketaab')(a, b)
Phi = symbols('Phi')
Phib = Function('Phib')(b)
Abtilde = Function('Abtilde')(b)
phitildeb = Function('phitildeb')(b)
phitildea = Function('phitildea')(a)
phitildeab = Function('phitildeab')(a, b)
rhoa = Function('rhoa')(a)
ketaa = Function('ketaa')(a)
Hbtilde = Function('Hbtild')(b)
Bbp = Function('Bbp')(b)
ZB = symbols('ZB')
pab = Function('pab')(a, b)
Xbf = Function('Xbf')(b, x)
VO = symbols('VO')
VObf = Function('VObf')(b, x)
VOf = Function('VOf')(x)
nprime = symbols('nprime')
sign = symbols('sign')
Vaf = Function('Vaf')(a, x)
Vabf = Function('Vabf')(a, b, x)
Vbtilde = Function('Vbtilde')(b)
Vaftilde = Function('Vaftilde')(a)
Vabftilde = Function('Vabftilde')(a, b)
Xaf = Function('Xaf')(a, x)
Aab = Function('Aab')(a, b)
jaf = Function('jaf')(a, x)
Xabf = Function('Xabf')(a, b, x)
gabf = Function('gabf')(a, b, x)
Ea = Function('Ea')(a)
Uf = Function('Uf')(x)
kappap = symbols('kappap')
rhop = symbols('rhop')
Phip = symbols('Phip')
xafs = Function('xafs')(a, x)
wab = Function('wab')(a, b)
eab = Function('eab')(a, b)
eba = Function('eba')(b, a)
lb = Function('lb')(b)
lbp = Function('lbp')(b)
lp = symbols('lp')
lab = Function('lab')(a, b)
Vab = Function('vab')(a, b)
lpp = symbols('lpp')
lppab = Function('lppab')(a, b)
Rhop = symbols('Rhop')
Rhob = Function('Rhob')(b)
Lamdap = symbols('Lamdap')
Lamdapp = symbols('Lamdapp')
Nab = Function('Nab')(a, b)
Nabtilde = Function('Nabtilde')
Trbf = Function('Trbf')(b, x)
orb = symbols('ORB')
tor = symbols('tor')
phifp = Function('phifp')(x)
hbp = Function('hbp')(b)
hab = Function('hab')(a, b)
rp = symbols('rp')
Lamdaa = Function('Lamdaa')(a)
Abf = Function('Abf')(b, x)
Lamdaf = Function('Lamdaf')(x)
SBb = Function('SBb')(b)
FOb = Function('FOb')(b)
Phitilde = symbols('phitilde')
Deltaatilde = Function('Deltaatilde')
Gbtilde = Function('Gbtilde')(b)
gabp = Function('gabp')(a, b)
xp = symbols('xp')
VObfp = Function('VObfp')(b, x)
Sbf = Function('Sbf')(b, x)
XO = symbols('XO') # operator
VObl = Function('VObl')(b)
matilde = Function('matilde')(a)
mabtilde = Function('mabtilde')(a, b)
VObfl = Function('VObfl')(b, x)
pO = symbols('pO')
uO = symbols('uO')
pOf = symbols('pO')
uOf = symbols('uO')
V = symbols('V')
Mbf = Function ('Mbf')(b, x)
deltaab = Function('deltaab')(a, b)
Gan = Function('Gan')(a)
AOab = Function('AOab')(a, b)
epsilonb = Function('epsilonb')(b)
chia = Function('chia')(a)
Lamdab = Function('Lamdab')(b)
Phibf = Function('Phibf')(b, x)
def starf(x9, y9): # give better def
    x9 * y9 = z
    return z
Sbp = Function('Sbp')(b)
fb = Function('Fb')(b)
ls = symbols('ls')
Ff = Function('Ff')(x)
ra = Function('ra')(a)
Fftilde = Function('Fftilde')(x)
Phif = Function('Phif')(x)
deltaba = Function('deltaba')(b, a)
alpha_xa1 = symbols() # check 324.5
Rhoa = Function('Rhoa')(a)
psibtilde = Function('psibtilde')(b)
psiatilde = Function('psiatilde')(a)
psiaf = Function('psiaf')(a, x)
psiaftilde = Function('Psiaftilde')(a, x)
jaftilde = Function('jaftilde')(a, x)
vtilde = symbols('vtilde')
psiabtilde = Function('psiabtilde')(a, b)
psiabf = Function('psiabf')(a, b, x)
psiabftilde = Function('psiabftilde')(a, b, x)
vp = symbols('vp')
NS = symbols('NS')
Sigma = symbols('Sigma')
Sigmaa = Function('Sigmaa')(a)
sB = symbols('sB')
sBp = symbols('sBp')
Hf = Function('Hf')(x)
psif = Function('psif')(x)
psilf = Function('psilf')(x)
psiftilde = Function('psiftilde')(x)
Hftilde = Function('Hftilde')(x)
psilftilde = Function('psiftilde')(x)
sigmabp = Function('sigmabp')(b)
AObf = Function('aobf')(b, x)
Theta = symbols('Theta')
Thetab = Function('Thetab')(b)
Thetaa = Function('Thetaa')(a)
Betab = Function('Betab')(b)
zetaf = Function('zetaf')(x)
lamdap = symbols('lamdap')
Sigmaf = Function('Sigmaf')(x)
kbf = Function('kbf')(b, x)
Cbf = Function('Cbf')(b, x)
B16 = symbols('b16')
B8 = symbols('b8')
B8p = symbols('b8p')
B16p = symbols('b16p')
Rhoab = Function('Rhoab')(a, b)
Ftilde = symbols('Ftilde')
Fbtilde = Function('Fbtilde')(b)
B56 = symbols('b56')
B56p = symbols('b56p')
VObtilde = Function('VObtilde')(b)
B1 = symbols('B1')
B28 = symbols('B28')
B35 = symbols('B35')
B8b = Function('B8b')(b)
pf = Function('pf')
ZBb = Function('ZBb')
Zabf = Function('Zabf')(a, b, x)
Zab = Function('Zab')(a, b)
psiltilde = symbols('psiltilde')
psitilde = symbols('psitilde')
psifp = Function('psifp')(x)
Htilde = symbols('Htilde')
Betatilde = symbols('Betatilde')
F1 = symbols('F1')
F2 = symbols('F2')
Zl = symbols('Zl')
lamdaaf = Function('lamdaaf')(a, x)
Oa = Function('Oa')(a)
B496 = symbols('B496')
NSp = symbols('NSp')
B128 = symbols('B128')
B120 = symbols('B120')
Haf = Function('Haf')(a, x)
B248 = symbols('B248')
epsilonf = Function('epsilonf')(x)
alphabp = Function('alphabp')(b)
tab = Function('tab')(a, b)
Tpp = symbols('Tpp')
Tp = symbols('Tp')
Ib = Function('Ib')(b)
Ua = Function('Ua')(a)
hf = Function('hf')(x)
Eb = Function('Eb')(b)
SU = Function('SU')(x)
B3 = symbols('B3')
B78 = symbols('B78')
B27 = symbols('B27')
B3l = symbols('B3l')
B27l = symbols('B27l')
B2 = symbols('B2')
B1b = Function('B1b')(b)
Ja = Function('Ja')(a)
Eab = Function('Eab')(a, b)
dimf = Function('dimf')(x)
Tbp = Function('Tbp')(b)
cp = symbols('cp')
rank = Function('rank')(x)
dab = Function('dab')(a, b)
thetaf = Function('thetaf')(x)
lf = symbols('lp')
Rhobtilde = Function('Rhobtilde')(b)
diag = Function('diag')(x,y,z,a)
ntilde = symbols('ntilde')
mp = symbols('mp')
nptilde = symbols('nptilde')
Gabf = Function('Gabf')
sigmaf = Function('sigmaf')
new = Function('new')
IIA = symbols('IIA')
CS = symbols('CS')
Cbp = Function('Cbp')(b)
lamdabp = Function('lamdabp')(b)
Star = Function('Star')
SBbp = Function('SBbp')(b)
SBbtilde = Function('SBbtilde')(b)
Fab = Function('Fab')(a, b)
IIB = symbols('IIB')
Fabp = Function('Fabp')(a, b)
Lamdaab = Function('Lamdaab')(a, b)
Gbp = Function('Gbp')(b)
Fbptilde = Function('Fbptilde')(b)
MOp = symbols('MOp')
het = symbols('het')
Fabf = Function('Fabf')(a, b)
Zfp = Function('Zfp')(x)
Ibf = Function('Ibf')(x)
trf = Function('trf')(x)
Rab = Function('Rab')(a, b)
SD = symbols('SD')
SBp = symbols('SBp')
SBpp = symbols('SBpp')
Y = symbols('Y')
Yb = Function('Yb')(b)
Xb = Function('Xb')(b)
thetal = symbols('thetal')
thetala = Function('thetala')(a)
Dab = Function('Dab')(a, b)
thetap = symbols('thetap')
thetapl = symbols('thetapl')
zpf = Function('zpf')(x)
ff = Function('ff')(x)
thetapf = Function('thetapf')(x)
phifpB = Function('phifpB')(x)
zB = symbols('zB')
zBpl = symbols('zBpl')
phifB = Function('phifB')(x)
zBp = symbols('zBp')
zBl = symbols('zBl')
etafl = Function('etafl')(x)
Psif = Function('Psif')(x)
OOf = Function('OOf')(x)
XaB = Function('XaB')(a)
XbB = Function('XbB')(b)
XafB = Function('XafB')(a, x)
zBb = Function('zBb')(b)
Cf = Function('Cf')(x)
XB = symbols('XB')
Rbf = Function('Rbf')(b, x)
DOb = Function('DOb')(b)
Habf = Function('Habf')(a, b, x)
Rhoabf = Function('Rhoabf')(a, b, x)
lamdaaB = Function('lamdaaB')(a)
chif = Function('chif')(x)
Fbf = Function('Fbf')(b, x)
gammatilde = symbols('gammatilde')
VOa = Function('VOa')(a)
VOabf = Function('VOabf')(a, b, x)
YM = symbols('YM')
Thetabf = Function('Thetabf')(b, x)
fa = Function('fa')(a)
ulb = Function('ulb')(b)
Kf = Function('kf')(x)
Rhof = Function('Rhof')(x)
Kbf = Function('Kbf')(b, x)
VOab = Function('VOab')(a, b)
deltapf = Function('deltapf')(x)
VOaf = Function('VOaf')(a, x)
fbf = Function('fbf')(b, x)
habf = Function('habf')(a, b, x)
alphaf = Function('alphaf')(x)
wb = Function('wb')(b)
wlb = Function('wlb')(b)
Betaftilde = Function('Betaftilde')(x)
gammaftilde = Function('gammaftilde')(x)
jl = symbols('jl')
Thetabtilde = Function('Thetabtilde')(b)
Vf = Function('Vf')(x)
psiafptilde = Function('psiafptilde')(a, x)
VObfptilde = Function('VObfptilde')(b, x)
VObftilde = Function('VObftilde')(b, x)
FBtilde = symbols('FBtilde')
Qbp = Function('Qbp')(b)
Qptilde = symbols('Qptilde')
Xpa = Function('Xpa')(a)
VObp = Function('VObp')(b)
VOptilde = Function('VOptilde')
Qlbtilde = Function('Qlbtilde')(b)
Qlb = Function('Qlb')(b)
lamdal = symbols('lamdal')
Trb = Function('Trb')(b)
tatilde = Function('tatilde')(a)
Qtilde = symbols('Qtilde')
Xaftilde = Function('Xaftilde')(a, x)
lbND = symbols('lbND')
Ref = Function('Ref')(x)
Imf = Function('Imf')(x)
Za = Function('Za')(a)
Zaf = Function('Zaf')(a, x)
LOaf = Function('LOaf')(a, x)
LOlaf = Function('LOlaf')(a, x)
phia = Function('phia')(a)
yab = Function('yab')(a, b)
rf = Function('rf')(x)
taua = Function('taua')(a)
ra = Function('ra')(a)
Ya = Function('Ya')(a)
Rhoaf = Function('Rhoaf')(x)
D9 = symbols('D9')
D5 = symbols('D5')
Fpb = Function('Fpb')(b)
Fpa = Function('Fpa')(a)
Apb = Function('Apb')(b)
Xpb = Function('Xpb')(b)
Qbtilde = Function('Qbtilde')
Wf = Function('Wf')(x)
Da = Function('Da')(a)
B4 = symbols('B4')
B4p = symbols('B4p')
Qp = symbols('Qp')
epsilonba = Function('epsilonba')(b, a)
B10 = symbols('B10')
Lamdaaf = Function('Lamdaaf')(a, x)
La = Function('La')(a)
lamdapa = Function('lamdapa')(a)
Mab = Function('Mab')(a, b)
Lf = Function('Lf')(x)
SLf = Function('SLf')(x)
Sf = Function('Sf')(x)
B2p = symbols('B2p')
M2 = symbols('M2')
M5 = symbols('M5')
Rbp = Function('Rpb')(b)
gpa = Function('gpa')(a)
Yab = Function('Yab')(a, b)
psibf = Function('psibf')(b, x)
eff = symbols('eff')
ppb = Function('ppb')(b)
bracketcb = Function('bracketbc')(x, b)
PB = symbols('PB')
bracketcab = Function('bracketcab')(x, a, b)
Aa = Function('Aa')(a)
Rbtilde = Function('Rbtilde')(b)
Ep = symbols('Ep')
rab = Function('rab')(a, b)
rb = Function('rb')(b)
nf = Function('nf')(x)
ha = Function('ha')(a)
MOab = Function('MOab')(a, b)
MOabf = Function('MOabf')(a, b, x)
Pf = Function('Pf')(x)
OObf = Function('OObf')(b, x)
ktilde = symbols('ktilde')
Betaabtilde = Function('Betaabtilde')(a, b)
FOabftilde = Function('FOabftilde')(a, b, x)
FOabf = Function('FOabf')(a, b, x)
hlb = Function('hlb')(b)
lO = symbols('lO')
NOb = Function('NOb')(b)
NObf = Function('NObf')(b, x)
LOab = Function('LOab')(a, b)
LOb = Function('LOb')(b)
fbftilde = Function('fbftilde')(b, x)
rtilde = symbols('rtilde')
stilde = symbols('stilde')
pair = Function('pair')(a, b)
af = Function('af')(x)
JOab = Function('JOab')(a, b)
qp = symbols('qp')
omegaas = Function('omegaas')(a) 
epsilonbf = Function('epsilonbf')(b, x)
Dabf = Function('Dabf')(a, b, x)
OOabf = Function('OOabf')(a, b, x)
OOabftilde = Function('OOabftilde')(a, b, x)
def SumDirect(x, y):
    x + y # or something
Ufb = Function('Ufb')(x, b)
chiabf = Function('chiabf')(a, b, x)
rpp = symbols('rpp')
nab = Function('nab')(a, b)
jabf = Function('jabf')(a, b, x)
Pbf = Function('Pbf')(b, x)
KOa = Function('KOa')(a)
ib = Function('ib')(b)
Deltaba = Function('Deltaba')(b, a)
hl = symbols('hl')
links = symbols('links')
OObftilde = Function('OObftilde')(b, x)
OObtilde = Function('OObtilde')(b)
Pl = symbols('Pl')
PhiB = symbols('PhiB')
PhiBb = Function('PhiBb')(b)
Zla = Function('Zla')(a)
Natilde = Function('Natilde')(a)
chibtilde = Function('chbitilde')(b)
la = Function('la')(a)
Dfb = Function('Dfb')(x, b)
B2l = symbols('B2l')
B4l = symbols('B4l')
xl = symbols('xl')
ll = symbols('ll')
Einstein = symbols('smart_guy')
nl = symbols('nl')
ml = symbols('ml')
yl = symbols('yl')
db = Function('db')(b)
Deltabtilde = Function('Deltabtilde')(b)
BObf = Function('BObf')(b, x)
Nf = Function('Nf')(x)
Kfp = Function('Kfp')(x)
ROb = Function('ROb')(b)
kl = symbols('kl')
B1l = symbols('B1l')
LObf = Function('LObf')(b, x)
Phiabf = Function('Phiabf')(a, b, x)
omegabfs = Function('omegabfs')(b, x)
abf = Function('abf')(b, x)
lamdaabf = Function('lamdaabf')(a, b, x)
Phiab = Function('Phiab')(a, b)
lamdalab = Function('lamdalab')(a, b)
Bl = symbols('Bl')
omegaabf = Function('omegaabf')(a, b, x)
bl = symbols('bl')
gOf = Function('gOf')(x)
Apa = Function('Apa')(a)
Bpb = Function('Bpb')(b)
Zpa = Function('Zpa')(a)
gOpb = Function('gOpb')(b)
Jtilde = symbols('Jtilde')
PhiBf = Function('PhiBf')(x)
kerf = Function('kerf')(x)
out = symbols('out')
inn = symbols('inn')
Betal = symbols('Betal')
alphal = symbols('alphal')
jabtilde = Function('jabtilde')(a, b)
japtilde = Function('japtilde')(a)
Tbpptilde = Function('long')(b)
Tabtilde = Function('Tabtilde')(a, b)
Tbptilde = Function('Tbptilde')(b)
jptilde = symbols('jptilde')
catilde = Function('catilde')(a)
cptilde = symbols('cptilde')
cpptilde = symbols('cpptilde')
Gabtilde = Function('Gabtilde')(a, b)
Lbptilde = Function('Lbptilde')(b)
grav = symbols('grav')
alphaabf = Function('alphaabf')(a, b, x)
GUT = symbols('GUT')
mua = Function('mua')(a)
thetabf = Function('thetabf')(b, x)
Ufb = Function('Ufb')(x, b)
Ufp = Function('Ufp')(x)
bab = Function('bab')(a, b)
EM = symbols('EM(inem)')
Jbtilde = Function('Jbtilde')(b)
Sbtilde = Function('Sbtilde')(b)
Sigmatilde = symbols('Sigmatilde')
Sigmaltilde = symbols('Sigmaltile')
Sigmaftilde = Function('Sigmaftilde')(x)
Sigmalftilde = Function('Sigmalftilde')(x)
Sigmaptilde = symbols('Sigmaptilde')
GSO = symbols('GSO')
def cov(x): # checkkkk (mate)
    x + 1
Wb = Function('Wb')(b)
Ka = Function('Ka')(a)
Phia = Function('Phia')(a)
ws = symbols('ws')
tl = symbols('tl')
Daf = Function('Daf')(a, x)
def comma(x):
    x + 1
uOl = symbols('uOl')
Qatilde = Function('Qatilde')(a)
atilde = symbols('atilde')
PhiaB = Function('PhiaB')(a)
PsiB = symbols('PsiB')
PhiafB = Function('PhiafB')(a, x)
PsiafB = Function('PsiafB')(a, x)
top = symbols('top')
ThetabB = Function('ThetabB')(b)
B16l = symbols('B16l')
B45 = symbols('B45')
Qpa = Function('Qpa')(a)
OOab = Function('OOab')(a, b)
OOpab = Function('OOpab')(a, b)
mbtilde = Function('mbtilde')
def SemiDirect(x, y):
    x + y
ZabB = Function('ZabB')(a, b)
PhiabB = Function('PhiabB')(a, b)
WO = symbols('WO')
gObf = Function('gObf')(b, x)
RaB = Function('RaB')(a)
cbf = Function('cbf')(b, x)
cabf = Function('cabf')(a, b, x)
Hbf = Function('Hbf')(b, x)
qab = Function('qab')(a, b)
gpp = symbols('gpp')
Rppb = Function('Rppb')(b)
Rpb = Function('Rpb')(b)
Rppba = Function('Rppba')(b, a)
K3 = symbols('K3')
RBa = Function('RBa')(a)
